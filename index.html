<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  <title>VibeDispatch - Dev</title>
  <script>
    (function() {
      try {
        const savedTheme = sessionStorage.getItem('hadoku-theme');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = savedTheme || (prefersDark ? 'dark' : 'light');

        document.documentElement.setAttribute('data-theme', theme);

        console.log('[theme-init] Applied initial theme:', {
          theme,
          savedTheme,
          prefersDark,
          source: savedTheme ? 'sessionStorage' : prefersDark ? 'browser-preference' : 'default'
        });
      } catch (err) {
        console.error('[theme-init] Failed to set initial theme:', err);
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>
<body>
  <div id="app"></div>
  <script type="module">
    import { mount } from './src/entry.tsx'

    // Get params from URL
    const params = new URLSearchParams(window.location.search)
    const theme = params.get('theme') || undefined // Let the app handle default theme

    console.log('[mount] Mounting vibedispatch with:', { theme })

    // Mount the app
    mount(document.getElementById('app'), {
      theme
    })
  </script>
</body>
</html>